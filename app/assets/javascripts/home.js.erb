$(document).ready(function(){
  renderBoard();
  renderPieces();
  movePieceListener();
});

function movePieceListener(){
  $('.piece').on('click', function(e){
    e.stopPropagation();
    $('.piece').off();
    if ($(".selected").length == 0){
    var piece = this;
      $(this).parent().toggleClass("selected");
    }
    $('.on').on('click', function(e){
      if ($(this).html() === ""){
        // e.stopPropagation();
        $(this).html(piece);
        $('.selected').html('');
        $('.on').off()
        movePieceListener()
      }
      $('.selected').toggleClass('selected');
      piece = ''
    });
  });

}

function renderBoard(){
  $(".even").html(renderRow("off"));
  $(".odd").html(renderRow("on"));
  $.makeArray($(".square")).forEach(function(square, index){
    $(square).attr('id', index)
  });
}

function renderSquare(color){
  return "<div class='" + color + " square'></div>"
}

function renderRow(firstColor){
  var row = "";
  if(firstColor === "off"){
    for(var i=0; i<4; i++){
      row = row + renderSquare("off") + renderSquare("on");
    }
  } else if(firstColor === "on"){
    for(var i=0; i<4; i++){
      row = row + renderSquare("on") + renderSquare("off");
    }
  }
  return row;
}

function renderPieces(){
  $('.p2-start > .on').append('<%= image_tag "burger", class:"p2 piece"%>')
  $('.p1-start > .on').append('<%= image_tag "yellow-burger", class:"p1 piece"%>')
}

// function choosePiece(){
//
//   $('.on').on('click', movePiece)
//   // debugger
// }

function movePiece(){
  debugger
  var square = this;
  var piece = $(this).html();
  $('.on').on('click', function(){
    $(square).html('');
    $(this).html(piece);
  });
}

// function toggleSquare(){
//
// }
