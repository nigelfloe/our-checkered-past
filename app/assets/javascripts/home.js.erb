$(document).ready(function(){
  var player1 = new Player('p1')
  var player2 = new Player('p2')
  renderBoard();
  renderPieces(player1, player2);
  Player.opponents()
  player1.takesTurn();
});

function playGame(player1, player2){
  player1.takesTurn();
}

function renderBoard(){
  $.makeArray($(".row")).forEach(function(row, y){
    $(row).html(renderRow(row, y));
  });
}

function renderRow(row, y){
  var html = "";
  if($(row).hasClass('even')){
    for(var i=0; i<4; i++){
      html = html + new Square("off", 2 * i, y).render() + new Square("on", 2 * i + 1, y).render();
    }
  } else if($(row).hasClass('odd')){
    for(var i=0; i<4; i++){
      html = html + new Square("on", 2 * i, y).render() + new Square("off", 2 * i + 1, y).render();
    }
  }
  return html;
}

function renderPieces(player1, player2){
  $.makeArray($('.p2-start > .on')).forEach(function(square, index){
    new Piece(player2).goToSquare(Square.findByPosition($(square).attr('x'), $(square).attr('y')));
  })
  $.makeArray($('.p1-start > .on')).forEach(function(square, index){
    new Piece(player1).goToSquare(Square.findByPosition($(square).attr('x'), $(square).attr('y')));
  })
}



function getPosition(square){
  return square.attr('position').split(',').map(Number);
}

function updateInfoPanel(player){
  $('.' + player.name + '-score').html(player.pieces().length);
  $('.' + player.opponent.name + '-score').html(player.opponent.pieces().length);
  $('.' + player.name + '-panel').toggleClass('turn-marker');
  $('.' + player.opponent.name + '-panel').toggleClass('turn-marker');
  $('.turn-count').html(Turn.all.length)
}
